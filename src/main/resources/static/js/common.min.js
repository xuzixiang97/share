!function(){var t=window.WL=function(){};t.Utils={isUrl:function(t){return/^(?:ht|f)tp(?:s)?\:\/\/(?:[\w\-\.]+)\.\w+/i.test(t)},isEmail:function(t){return-1!==t.search(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)},isNumber:function(t){return-1!==t.search(/^\d+$/)},isMobile:function(t){return-1!==t.search(/^(13|14|15|17|18)\d{9}$/)},getQueryString:function(t){var e=[];for(var i in t)e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e.join("&")},getQueryParams:function(t){var e={},i=(t=t&&t.split("#")[0]||window.location.search).indexOf("?");if(-1<i)for(var a=0,o=(t=t.substring(t.indexOf("?")+1)).split("&");a<o.length;a++){i=o[a].indexOf("=");var s=decodeURIComponent(o[a].substring(0,i)),n=decodeURIComponent(o[a].substring(i+1));e[s]=n}return e},limitLength:function(t,e){var i=t.value.replace(/[^x00-xff]/g,"**");if(!(1*i.length<=1*e)){for(var a=i.substr(0,e),o=0,s="",n=0;n<a.length;n++){"*"==a.substr(n,1)&&o++}var r=0;i.substr(1*e-1,1);s=(r=o%2==0?o/2+(1*e-o):(o-1)/2+(1*e-o),t.value.substr(0,r)),t.value=s}},openWin:function(t,e,i){var a=Math.round((window.screen.availWidth-e)/2),o=Math.round((window.screen.availHeight-100-i)/2);window.open(t,"","height="+i+", width="+e+",top="+o+",left="+a+", toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no")},SessionStorage:{support:"sessionStorage"in window&&null!==window.sessionStorage,setItem:function(t,e){this.support&&window.sessionStorage.setItem(t,e)},getItem:function(t){return this.support?window.sessionStorage.getItem(t):null},removeItem:function(t){this.support&&window.sessionStorage.removeItem(t)},clear:function(){this.support&&window.sessionStorage.clear()}}},t.History={waitTime:1,add:function(t){setTimeout(function(){$.post(t.url,t,function(t){})},1e3*this.waitTime)}},t.Navigation={_key:"NavigationUrls",_Storage:t.Utils.SessionStorage,init:function(){this._Storage.setItem(this._key,"[]")},set:function(t){t="string"==typeof t?t:JSON.stringify(t),this._Storage.setItem(this._key,t)},get:function(){var e=this._Storage.getItem(this._key);try{e=JSON.parse(e)}catch(t){e=[]}return e},add:function(t){t&&this.init();var e=this.get()||[];0==e.length?(e.push(location.href),this.set(e)):(0==$(".navbar-brand").find("span").length&&(e=[]),0!=e.length&&e[e.length-1]==location.href||(e.push(location.href),this.set(e)))},back:function(t,e){var i=this.get();i&&i.length&&(0==$(t).find("span").length?this.add(!0):1<i.length&&(i=i.slice(0,i.length-1),this.set(i),location.href=i[i.length-1],e.preventDefault()))}}}();var modeltool={params:{},timeout:null,initparams:function(t){this.params=t,this.showmodelimg(),this.addhistory(!0)},zoomin:function(){this.changemodeldpi(1),this.showmodelimg()},zoomout:function(){this.changemodeldpi(-1),this.showmodelimg()},moveup:function(){this.changemodelxy(0,20),this.showmodelimg()},movedown:function(){this.changemodelxy(0,-10),this.showmodelimg()},moveleft:function(){this.changemodelxy(10,0),this.showmodelimg()},moveright:function(){this.changemodelxy(-5,0),this.showmodelimg()},changemodelxy:function(t,e){this.params.df_modelx+=t,this.params.df_modely+=e},changemodeldpi:function(t){var e=this.params.photocurrentdpi;e+=.15*e*t,(e=parseInt(e))<100&&(e=100),1e3<e&&(e=1e3),this.params.photocurrentdpi=e,$(".df_dpi_current").html(parseInt(100*this.params.photodpi/(1*e))+"%")},showmodelimg:function(){var t=this.getmodelimg();t&&($(".design_showmodel_link").attr("href",t),$(".design_showmodel_img").attr("src",t).removeClass("hidden"),-1==location.href.indexOf("qfc=")&&this.resize())},getmodelimg:function(){if(!this.params.model){if($(".photodetail_left .modelcon:visible").length){var t=$(".photodetail_left .modelcon:visible li:eq(0)");this.params.model=t.find("a").addClass("active").attr("rel")}else console.log("no available model ...");if(!this.params.model)return""}if(this.params.isvip&&0==$(".imvip").length)return"";var e=[];e.push("/3d/do/?action=result&folder="+this.params.model),e.push("&photoid="+this.params.photoid),e.push("&zoom="+parseInt(100*this.params.photodpi/(1*this.params.photocurrentdpi))),e.push("&dx="+this.params.df_modelx),e.push("&dy="+this.params.df_modely),e.push("&photokey="+dinfo.photokey),e.push(this.params.customization?"&viewing=special":""),e.push(this.params.haspiece?"&haspiece=1":"");var i=e.join("");return $('.sharesamples input[name="params"]').val(i.replace("/3d/do/?","")),i},resize:function(){this.params.ismobile&&($(".colitem_showmodel_navs").addClass("hidden"),$(".repeatnavs, .samplenavs, .fabricwidth").removeClass("hidden"),$(".photodetail_section .colitem_design_showah").remove());var t=$("body").width(),e=$("body").height()-44,i=$(".advbanners").outerHeight(!0),a=$(".photodetail_toolbar").outerHeight(!0),o=$(".photodetail_main .prevnext").outerWidth(!0),s=e-$(".photodetail_right .buyareas").outerHeight(!0),n=t-$(".photodetail_left").outerWidth(!0)-$(".photodetail_right").outerWidth(!0),r=e-i-a,h=$(".photodetail_left .nicescroll:visible").height(),d=e-$(".photodetail_left ul").height();$(".photodetail").height(e),$(".photodetail_main").width(n-1),$(".photodetail_right>.row").height(s),$(".photodetail_moredesigns").width(n-160),$(".photodetail_section .modelarea").width(n-2*o),$(".photodetail_section, .photodetail_section .design_show").height(r),$(".photodetail_left .nicescroll").height(h+d),this.sameheight()},sameheight:function(){$(".photodetail_section .imgsameheight").removeAttr("style"),$(".photodetail_section .design_show:visible").imagesLoaded(function(){$(".photodetail_section .colitem_design").css("width","auto"),$(".photodetail_section .design_show").css("width","auto").height($(".photodetail_section").height());var t=$(".colitem_showmodel_navs").outerWidth(!0),e=$(".photodetail_main .prevnext").outerWidth(!0),i=$(".photodetail_main").width()-2*e,a=$(".photodetail_main .tableitem").outerWidth(!0),o=a-i;if(0<o){var s=a-t,n=(s-o)/s;$(".photodetail_section .colitem_design:visible").each(function(){var t=$(this).outerWidth(!0),e=$(this).outerHeight(!0),i=parseInt(n*t),a=parseInt(n*e);$(this).find(".design_show").width(i),$(this).find(".design_show").height(a)}),$(".imgsameheight:visible").css({width:"100%",height:"100%"})}else $(".imgsameheight:visible").each(function(){var t=$(this).outerWidth(!0);$(this).parents(".design_show").width(t)})})},showdesign:function(){$(".colitem_design_showah").toggleClass("hidden"),$(".colitem_design_showah").hasClass("hidden")?($(".colitem_showmodel_navs").removeClass("hidden"),$(".repeatnavs, .samplenavs, .fabricwidth").addClass("hidden")):($(".colitem_showmodel_navs").addClass("hidden"),$(".repeatnavs, .samplenavs, .fabricwidth").removeClass("hidden"),$(".repeatnavs a.showmodeldesign").addClass("active")),this.resize();var t=this;setTimeout(function(){t.addhistory()},1e3)},showdesignmodel:function(){$(".design_repeat_fabricwidth").addClass("hidden"),$(".positionnavs, .advbanners").removeClass("hidden"),$(".repeatnavs a.active").removeClass("active"),$(".repeatnavs a.showmodeldesign").addClass("active"),$(".modelarea>.tableitem").is(":visible")||$(".photodetail_section .prevnext, .modelarea>.tableitem, .design_repeat_fm").toggleClass("hidden")},downloadsample:function(){$("form.vipsample input:submit").trigger("click"),this.addhistory()},addhistory:function(t){var e=this.params.params;e&&e.userid&&(t?WL.History.add(e):e.action||(e.action="viewshowah",WL.History.add(e)))},designrealsize:function(t){var e={height:$(".photodetail_section").height(),background:"none"},i="/photos/transfer/"+dinfo.photoid+"_realsize.jpg";$(".photodetail_section .prevnext, .modelarea>.tableitem").addClass("hidden"),$(".design_repeat_fm").html('<img alt="" src="'+i+'">').css(e).removeClass("hidden"),$(".positionnavs, .advbanners").addClass("hidden"),$(".fabricwidth").removeClass("hidden"),$(".repeatnavs a.active").removeClass("active"),$(".design_repeat_fabricwidth").addClass("hidden"),$(".photodetail_left .modelcon a.active").removeClass("active"),$(t).addClass("active")},designrepeat:function(t){$(".photodetail_section .prevnext, .modelarea>.tableitem").addClass("hidden"),$(".design_repeat_fm").html("").css({width:"100%",height:"100%"}).removeClass("hidden"),$(".positionnavs, .advbanners").addClass("hidden"),$(".fabricwidth, .design_repeat_fabricwidth").removeClass("hidden"),$(".repeatnavs a.active").removeClass("active"),$(".photodetail_left .modelcon a.active").removeClass("active"),$(t).addClass("active");var e=$(t).attr("rel").replace("repeat_",""),i=$(".design_repeat_fm").outerWidth(!0),a=$(".fabricwidth option:selected").val();"custom"==a&&(a=$(".customwidth").val()),a=a||0;var o=$(".repeatnavs a.repeat_rotate").data("rotate"),s="/photos/transfer/"+dinfo.photoid+"_"+e+".jpg?px="+i+"&fw="+a+"&rotate="+o;"realsize"==e?$(".design_repeat_fm").css({background:"url("+s+") #000 no-repeat center"}):$(".design_repeat_fm").css({background:"url("+s+")"}),this.resize()},designrotate:function(t){var e=parseInt($(t).data("rotate"))+90;360<=e&&(e=0),$(t).data("rotate",e),$(".repeatnavs a.active[rel]").trigger("click")}};function getids(t){var e=[];return t=t||"id",$('input[name="'+t+'"]:checked').each(function(){e.push($(this).val())}),e.join(",")}function checkallcbs(t,e){e=e||"id",(t=t||$("#checkall")).on("change",function(){var t=$(this).is(":checked");$('input[name="'+e+'"]').each(function(){t?$(this).prop("checked",!0):$(this).prop("checked",!1)})})}function checkprogress(){$(".lblcheckprogress").show(),$(".lblcheckprogress").load("/api/checkprogress/?t="+(new Date).valueOf(),function(){setTimeout("checkprogress()",3e3)})}function modalreposition(){var t=$(this),e=t.find(".modal-dialog");t.css("display","block"),e.css("margin-top",Math.max(0,($(window).height()-e.height())/2))}function showloading(t){return(t=$(t)).after('<img src="/static/images/lightbox-ico-loading.gif" alt="Loading ..." />'),t.is("input")&&t.val("Uploading ..."),t.is("button")&&t.html("Uploading ..."),!0}function tostring(t,e){var i=t+".000000001";if(-1==i.indexOf("."))return i;var a=i.split("."),o=a[0],s=(a[1]+"0000000000").substr(0,e);return"0"==s&&(s=""),a=o,0<s.length&&(a+="."+s),a}function ajax_form_pars(t){var e={};if($(t).find("input").each(function(){"radio"==$(this).attr("type")||"checkbox"==$(this).attr("type")?$(this).prop("checked")&&(e[$(this).attr("name")]=$(this).val()):e[$(this).attr("name")]=$(this).val()}),$(t).find("select").each(function(){e[$(this).attr("name")]=$(this).val()}),$(t).find("textarea").each(function(){e[$(this).attr("name")]=$(this).val()}),e.is_api="1",e.is_ajax="1",e.ajax="1",1<$(t).find('input[name="name"]').length){var i=new Array;$(t).find('input[name="name"]').each(function(t){i[t]=$(this).val()}),e.name=i}return e}function ajax_form_after(t){setTimeout("$('.formmsg').remove()",5e3),$(".chk").prop("checked",!1),$(".btn_selectall").attr("rel","0")}function init_ajax_link_form(){location.href.indexOf("127.0.0.1"),$(".ajaxlink").click(function(){return $(".formmsg").remove(),0==$(this).parent().find(".formmsg").length&&$(this).parent().append('<span class="formmsg label label-success">loading ...</span>'),$.get($(this).attr("href"),function(t){}),!1}),$(".ajaxform").submit(function(){if(0<$(".ajaxform_go").length)return!0;0<$(this).parent().find('input[type="submit"]').length?$(this).parent().find('input[type="submit"]').eq(0).before('<span class="formmsg alert alert-warning"></span>'):0==$(this).parent().find(".formmsg").length&&$(this).parent().append('<span class="formmsg aler1t alert-warning"></span>'),$(this).parent().find(".formmsg").show(),$(this).parent().find(".formmsg").html("loading ...");var t=$(this).attr("action");t=t||location.href;var e=ajax_form_pars(this);return"multipart/form-data"==$(this).attr("enctype")?(e=new FormData(this),$.ajax({url:t,type:"POST",data:e,processData:!1,contentType:!1,success:function(t){"1"==t?$(".formmsg").html('<span class="glyphicon glyphicon-ok"></span>'):$(".formmsg").html(t),ajax_form_after(t)}})):$.post(t,e,function(t){"1"==t?$(".formmsg").html('<span class="glyphicon glyphicon-ok"></span>'):$(".formmsg").html(t),ajax_form_after(t)}),!1})}$(function(){$('[data-toogle="tooltip"]').tooltip(),$("img.lazy").lazyload({threshold:50})});